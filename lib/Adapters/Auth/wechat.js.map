{"version":3,"sources":["../../../src/Adapters/Auth/wechat.js"],"names":["httpsRequest","require","Parse","validateAuthData","authData","graphRequest","access_token","id","then","data","errcode","Error","OBJECT_NOT_FOUND","validateAppId","Promise","resolve","path","get","module","exports"],"mappings":";;AAAA;AACA,MAAMA,YAAY,GAAGC,OAAO,CAAC,gBAAD,CAA5B;;AACA,IAAIC,KAAK,GAAGD,OAAO,CAAC,YAAD,CAAP,CAAsBC,KAAlC,C,CAEA;;;AACA,SAASC,gBAAT,CAA0BC,QAA1B,EAAoC;AAClC,SAAOC,YAAY,CAAC,uBAAuBD,QAAQ,CAACE,YAAhC,GAA+C,UAA/C,GAA4DF,QAAQ,CAACG,EAAtE,CAAZ,CAAsFC,IAAtF,CACL,UAAUC,IAAV,EAAgB;AACd,QAAIA,IAAI,CAACC,OAAL,IAAgB,CAApB,EAAuB;AACrB;AACD;;AACD,UAAM,IAAIR,KAAK,CAACS,KAAV,CAAgBT,KAAK,CAACS,KAAN,CAAYC,gBAA5B,EAA8C,uCAA9C,CAAN;AACD,GANI,CAAP;AAQD,C,CAED;;;AACA,SAASC,aAAT,GAAyB;AACvB,SAAOC,OAAO,CAACC,OAAR,EAAP;AACD,C,CAED;;;AACA,SAASV,YAAT,CAAsBW,IAAtB,EAA4B;AAC1B,SAAOhB,YAAY,CAACiB,GAAb,CAAiB,mCAAmCD,IAApD,CAAP;AACD;;AAEDE,MAAM,CAACC,OAAP,GAAiB;AACfN,EAAAA,aADe;AAEfV,EAAAA;AAFe,CAAjB","sourcesContent":["// Helper functions for accessing the WeChat Graph API.\nconst httpsRequest = require('./httpsRequest');\nvar Parse = require('parse/node').Parse;\n\n// Returns a promise that fulfills iff this user id is valid.\nfunction validateAuthData(authData) {\n  return graphRequest('auth?access_token=' + authData.access_token + '&openid=' + authData.id).then(\n    function (data) {\n      if (data.errcode == 0) {\n        return;\n      }\n      throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'wechat auth is invalid for this user.');\n    }\n  );\n}\n\n// Returns a promise that fulfills if this app id is valid.\nfunction validateAppId() {\n  return Promise.resolve();\n}\n\n// A promisey wrapper for WeChat graph requests.\nfunction graphRequest(path) {\n  return httpsRequest.get('https://api.weixin.qq.com/sns/' + path);\n}\n\nmodule.exports = {\n  validateAppId,\n  validateAuthData,\n};\n"],"file":"wechat.js"}