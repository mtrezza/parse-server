{"version":3,"sources":["../../src/Routers/AudiencesRouter.js"],"names":["AudiencesRouter","ClassesRouter","className","handleFind","req","body","Object","assign","JSONFromQuery","query","options","optionsFromBody","rest","find","config","auth","where","info","clientSDK","context","then","response","results","forEach","item","JSON","parse","handleGet","data","mountRoutes","route","middleware","promiseEnforceMasterKeyAccess","handleCreate","handleUpdate","handleDelete"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;AAEO,MAAMA,eAAN,SAA8BC,sBAA9B,CAA4C;AACjDC,EAAAA,SAAS,GAAG;AACV,WAAO,WAAP;AACD;;AAEDC,EAAAA,UAAU,CAACC,GAAD,EAAM;AACd,UAAMC,IAAI,GAAGC,MAAM,CAACC,MAAP,CAAcH,GAAG,CAACC,IAAlB,EAAwBJ,uBAAcO,aAAd,CAA4BJ,GAAG,CAACK,KAAhC,CAAxB,CAAb;;AACA,UAAMC,OAAO,GAAGT,uBAAcU,eAAd,CAA8BN,IAA9B,CAAhB;;AAEA,WAAOO,cACJC,IADI,CAEHT,GAAG,CAACU,MAFD,EAGHV,GAAG,CAACW,IAHD,EAIH,WAJG,EAKHV,IAAI,CAACW,KALF,EAMHN,OANG,EAOHN,GAAG,CAACa,IAAJ,CAASC,SAPN,EAQHd,GAAG,CAACa,IAAJ,CAASE,OARN,EAUJC,IAVI,CAUCC,QAAQ,IAAI;AAChBA,MAAAA,QAAQ,CAACC,OAAT,CAAiBC,OAAjB,CAAyBC,IAAI,IAAI;AAC/BA,QAAAA,IAAI,CAACf,KAAL,GAAagB,IAAI,CAACC,KAAL,CAAWF,IAAI,CAACf,KAAhB,CAAb;AACD,OAFD;AAIA,aAAO;AAAEY,QAAAA,QAAQ,EAAEA;AAAZ,OAAP;AACD,KAhBI,CAAP;AAiBD;;AAEDM,EAAAA,SAAS,CAACvB,GAAD,EAAM;AACb,WAAO,MAAMuB,SAAN,CAAgBvB,GAAhB,EAAqBgB,IAArB,CAA0BQ,IAAI,IAAI;AACvCA,MAAAA,IAAI,CAACP,QAAL,CAAcZ,KAAd,GAAsBgB,IAAI,CAACC,KAAL,CAAWE,IAAI,CAACP,QAAL,CAAcZ,KAAzB,CAAtB;AAEA,aAAOmB,IAAP;AACD,KAJM,CAAP;AAKD;;AAEDC,EAAAA,WAAW,GAAG;AACZ,SAAKC,KAAL,CAAW,KAAX,EAAkB,iBAAlB,EAAqCC,UAAU,CAACC,6BAAhD,EAA+E5B,GAAG,IAAI;AACpF,aAAO,KAAKD,UAAL,CAAgBC,GAAhB,CAAP;AACD,KAFD;AAGA,SAAK0B,KAAL,CACE,KADF,EAEE,2BAFF,EAGEC,UAAU,CAACC,6BAHb,EAIE5B,GAAG,IAAI;AACL,aAAO,KAAKuB,SAAL,CAAevB,GAAf,CAAP;AACD,KANH;AAQA,SAAK0B,KAAL,CAAW,MAAX,EAAmB,iBAAnB,EAAsCC,UAAU,CAACC,6BAAjD,EAAgF5B,GAAG,IAAI;AACrF,aAAO,KAAK6B,YAAL,CAAkB7B,GAAlB,CAAP;AACD,KAFD;AAGA,SAAK0B,KAAL,CACE,KADF,EAEE,2BAFF,EAGEC,UAAU,CAACC,6BAHb,EAIE5B,GAAG,IAAI;AACL,aAAO,KAAK8B,YAAL,CAAkB9B,GAAlB,CAAP;AACD,KANH;AAQA,SAAK0B,KAAL,CACE,QADF,EAEE,2BAFF,EAGEC,UAAU,CAACC,6BAHb,EAIE5B,GAAG,IAAI;AACL,aAAO,KAAK+B,YAAL,CAAkB/B,GAAlB,CAAP;AACD,KANH;AAQD;;AAnEgD;;;eAsEpCJ,e","sourcesContent":["import ClassesRouter from './ClassesRouter';\nimport rest from '../rest';\nimport * as middleware from '../middlewares';\n\nexport class AudiencesRouter extends ClassesRouter {\n  className() {\n    return '_Audience';\n  }\n\n  handleFind(req) {\n    const body = Object.assign(req.body, ClassesRouter.JSONFromQuery(req.query));\n    const options = ClassesRouter.optionsFromBody(body);\n\n    return rest\n      .find(\n        req.config,\n        req.auth,\n        '_Audience',\n        body.where,\n        options,\n        req.info.clientSDK,\n        req.info.context\n      )\n      .then(response => {\n        response.results.forEach(item => {\n          item.query = JSON.parse(item.query);\n        });\n\n        return { response: response };\n      });\n  }\n\n  handleGet(req) {\n    return super.handleGet(req).then(data => {\n      data.response.query = JSON.parse(data.response.query);\n\n      return data;\n    });\n  }\n\n  mountRoutes() {\n    this.route('GET', '/push_audiences', middleware.promiseEnforceMasterKeyAccess, req => {\n      return this.handleFind(req);\n    });\n    this.route(\n      'GET',\n      '/push_audiences/:objectId',\n      middleware.promiseEnforceMasterKeyAccess,\n      req => {\n        return this.handleGet(req);\n      }\n    );\n    this.route('POST', '/push_audiences', middleware.promiseEnforceMasterKeyAccess, req => {\n      return this.handleCreate(req);\n    });\n    this.route(\n      'PUT',\n      '/push_audiences/:objectId',\n      middleware.promiseEnforceMasterKeyAccess,\n      req => {\n        return this.handleUpdate(req);\n      }\n    );\n    this.route(\n      'DELETE',\n      '/push_audiences/:objectId',\n      middleware.promiseEnforceMasterKeyAccess,\n      req => {\n        return this.handleDelete(req);\n      }\n    );\n  }\n}\n\nexport default AudiencesRouter;\n"],"file":"AudiencesRouter.js"}