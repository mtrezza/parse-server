{"version":3,"sources":["../src/TestUtils.js"],"names":["destroyAllDataPermanently","fast","process","env","TESTING","Promise","all","Object","keys","AppCache","cache","map","appId","app","get","databaseController","deleteEverything","resolve"],"mappings":";;;;;;;AAAA;;;;AAEA;AACA;AACA;AACA;AACO,SAASA,yBAAT,CAAmCC,IAAnC,EAAyC;AAC9C,MAAI,CAACC,OAAO,CAACC,GAAR,CAAYC,OAAjB,EAA0B;AACxB,UAAM,oCAAN;AACD;;AACD,SAAOC,OAAO,CAACC,GAAR,CACLC,MAAM,CAACC,IAAP,CAAYC,eAASC,KAArB,EAA4BC,GAA5B,CAAgCC,KAAK,IAAI;AACvC,UAAMC,GAAG,GAAGJ,eAASK,GAAT,CAAaF,KAAb,CAAZ;;AACA,QAAIC,GAAG,CAACE,kBAAR,EAA4B;AAC1B,aAAOF,GAAG,CAACE,kBAAJ,CAAuBC,gBAAvB,CAAwCf,IAAxC,CAAP;AACD,KAFD,MAEO;AACL,aAAOI,OAAO,CAACY,OAAR,EAAP;AACD;AACF,GAPD,CADK,CAAP;AAUD","sourcesContent":["import AppCache from './cache';\n\n/**\n * Destroys all data in the database\n * @param {boolean} fast set to true if it's ok to just drop objects and not indexes.\n */\nexport function destroyAllDataPermanently(fast) {\n  if (!process.env.TESTING) {\n    throw 'Only supported in test environment';\n  }\n  return Promise.all(\n    Object.keys(AppCache.cache).map(appId => {\n      const app = AppCache.get(appId);\n      if (app.databaseController) {\n        return app.databaseController.deleteEverything(fast);\n      } else {\n        return Promise.resolve();\n      }\n    })\n  );\n}\n"],"file":"TestUtils.js"}