{"version":3,"sources":["../../../src/GraphQL/transformers/mutation.js"],"names":["transformTypes","inputType","fields","className","parseGraphQLSchema","req","classGraphQLCreateType","classGraphQLUpdateType","config","isCreateEnabled","isUpdateEnabled","parseClassTypes","parseClass","parseClasses","find","clazz","classGraphQLCreateTypeFields","getFields","classGraphQLUpdateTypeFields","promises","Object","keys","map","field","inputTypeField","type","defaultGraphQLTypes","GEO_POINT_INPUT","transformers","geoPoint","POLYGON_INPUT","polygon","FILE_INPUT","file","relation","targetClass","pointer","Promise","all","ACL","upload","fileInfo","__type","name","url","Parse","Error","FILE_SAVE_ERROR","value","coordinates","latitude","longitude","parseACL","public","read","write","users","forEach","rule","globalIdObject","userId","id","roles","roleName","auth","info","length","INVALID_POINTER","op","__op","ops","nestedObjectsToAdd","createAndAdd","input","parseFields","objectsMutations","createObject","object","objectId","add","push","objects","remove","nestedObjectToAdd","createAndLink","link"],"mappings":"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","sourcesContent":["import Parse from 'parse/node';\nimport { fromGlobalId } from 'graphql-relay';\nimport { handleUpload } from '../loaders/filesMutations';\nimport * as defaultGraphQLTypes from '../loaders/defaultGraphQLTypes';\nimport * as objectsMutations from '../helpers/objectsMutations';\n\nconst transformTypes = async (\n  inputType: 'create' | 'update',\n  fields,\n  { className, parseGraphQLSchema, req }\n) => {\n  const {\n    classGraphQLCreateType,\n    classGraphQLUpdateType,\n    config: { isCreateEnabled, isUpdateEnabled },\n  } = parseGraphQLSchema.parseClassTypes[className];\n  const parseClass = parseGraphQLSchema.parseClasses.find(clazz => clazz.className === className);\n  if (fields) {\n    const classGraphQLCreateTypeFields =\n      isCreateEnabled && classGraphQLCreateType ? classGraphQLCreateType.getFields() : null;\n    const classGraphQLUpdateTypeFields =\n      isUpdateEnabled && classGraphQLUpdateType ? classGraphQLUpdateType.getFields() : null;\n    const promises = Object.keys(fields).map(async field => {\n      let inputTypeField;\n      if (inputType === 'create' && classGraphQLCreateTypeFields) {\n        inputTypeField = classGraphQLCreateTypeFields[field];\n      } else if (classGraphQLUpdateTypeFields) {\n        inputTypeField = classGraphQLUpdateTypeFields[field];\n      }\n      if (inputTypeField) {\n        switch (true) {\n          case inputTypeField.type === defaultGraphQLTypes.GEO_POINT_INPUT:\n            fields[field] = transformers.geoPoint(fields[field]);\n            break;\n          case inputTypeField.type === defaultGraphQLTypes.POLYGON_INPUT:\n            fields[field] = transformers.polygon(fields[field]);\n            break;\n          case inputTypeField.type === defaultGraphQLTypes.FILE_INPUT:\n            fields[field] = await transformers.file(fields[field], req);\n            break;\n          case parseClass.fields[field].type === 'Relation':\n            fields[field] = await transformers.relation(\n              parseClass.fields[field].targetClass,\n              field,\n              fields[field],\n              parseGraphQLSchema,\n              req\n            );\n            break;\n          case parseClass.fields[field].type === 'Pointer':\n            fields[field] = await transformers.pointer(\n              parseClass.fields[field].targetClass,\n              field,\n              fields[field],\n              parseGraphQLSchema,\n              req\n            );\n            break;\n        }\n      }\n    });\n    await Promise.all(promises);\n    if (fields.ACL) fields.ACL = transformers.ACL(fields.ACL);\n  }\n  return fields;\n};\n\nconst transformers = {\n  file: async ({ file, upload }, { config }) => {\n    if (file === null && !upload) {\n      return null;\n    }\n    if (upload) {\n      const { fileInfo } = await handleUpload(upload, config);\n      return { ...fileInfo, __type: 'File' };\n    } else if (file && file.name) {\n      return { name: file.name, __type: 'File', url: file.url };\n    }\n    throw new Parse.Error(Parse.Error.FILE_SAVE_ERROR, 'Invalid file upload.');\n  },\n  polygon: value => ({\n    __type: 'Polygon',\n    coordinates: value.map(geoPoint => [geoPoint.latitude, geoPoint.longitude]),\n  }),\n  geoPoint: value => ({\n    ...value,\n    __type: 'GeoPoint',\n  }),\n  ACL: value => {\n    const parseACL = {};\n    if (value.public) {\n      parseACL['*'] = {\n        read: value.public.read,\n        write: value.public.write,\n      };\n    }\n    if (value.users) {\n      value.users.forEach(rule => {\n        const globalIdObject = fromGlobalId(rule.userId);\n        if (globalIdObject.type === '_User') {\n          rule.userId = globalIdObject.id;\n        }\n        parseACL[rule.userId] = {\n          read: rule.read,\n          write: rule.write,\n        };\n      });\n    }\n    if (value.roles) {\n      value.roles.forEach(rule => {\n        parseACL[`role:${rule.roleName}`] = {\n          read: rule.read,\n          write: rule.write,\n        };\n      });\n    }\n    return parseACL;\n  },\n  relation: async (targetClass, field, value, parseGraphQLSchema, { config, auth, info }) => {\n    if (Object.keys(value).length === 0)\n      throw new Parse.Error(\n        Parse.Error.INVALID_POINTER,\n        `You need to provide at least one operation on the relation mutation of field ${field}`\n      );\n\n    const op = {\n      __op: 'Batch',\n      ops: [],\n    };\n    let nestedObjectsToAdd = [];\n\n    if (value.createAndAdd) {\n      nestedObjectsToAdd = (\n        await Promise.all(\n          value.createAndAdd.map(async input => {\n            const parseFields = await transformTypes('create', input, {\n              className: targetClass,\n              parseGraphQLSchema,\n              req: { config, auth, info },\n            });\n            return objectsMutations.createObject(targetClass, parseFields, config, auth, info);\n          })\n        )\n      ).map(object => ({\n        __type: 'Pointer',\n        className: targetClass,\n        objectId: object.objectId,\n      }));\n    }\n\n    if (value.add || nestedObjectsToAdd.length > 0) {\n      if (!value.add) value.add = [];\n      value.add = value.add.map(input => {\n        const globalIdObject = fromGlobalId(input);\n        if (globalIdObject.type === targetClass) {\n          input = globalIdObject.id;\n        }\n        return {\n          __type: 'Pointer',\n          className: targetClass,\n          objectId: input,\n        };\n      });\n      op.ops.push({\n        __op: 'AddRelation',\n        objects: [...value.add, ...nestedObjectsToAdd],\n      });\n    }\n\n    if (value.remove) {\n      op.ops.push({\n        __op: 'RemoveRelation',\n        objects: value.remove.map(input => {\n          const globalIdObject = fromGlobalId(input);\n          if (globalIdObject.type === targetClass) {\n            input = globalIdObject.id;\n          }\n          return {\n            __type: 'Pointer',\n            className: targetClass,\n            objectId: input,\n          };\n        }),\n      });\n    }\n    return op;\n  },\n  pointer: async (targetClass, field, value, parseGraphQLSchema, { config, auth, info }) => {\n    if (Object.keys(value).length > 1 || Object.keys(value).length === 0)\n      throw new Parse.Error(\n        Parse.Error.INVALID_POINTER,\n        `You need to provide link OR createLink on the pointer mutation of field ${field}`\n      );\n\n    let nestedObjectToAdd;\n    if (value.createAndLink) {\n      const parseFields = await transformTypes('create', value.createAndLink, {\n        className: targetClass,\n        parseGraphQLSchema,\n        req: { config, auth, info },\n      });\n      nestedObjectToAdd = await objectsMutations.createObject(\n        targetClass,\n        parseFields,\n        config,\n        auth,\n        info\n      );\n      return {\n        __type: 'Pointer',\n        className: targetClass,\n        objectId: nestedObjectToAdd.objectId,\n      };\n    }\n    if (value.link) {\n      let objectId = value.link;\n      const globalIdObject = fromGlobalId(objectId);\n      if (globalIdObject.type === targetClass) {\n        objectId = globalIdObject.id;\n      }\n      return {\n        __type: 'Pointer',\n        className: targetClass,\n        objectId,\n      };\n    }\n  },\n};\n\nexport { transformTypes };\n"],"file":"mutation.js"}